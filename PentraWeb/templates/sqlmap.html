<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PentraWeb - SQLMap SQL Injection Scanner</title>
    <link rel="stylesheet" href="../Static/css/homepage.css"> <!-- Link to your main CSS file -->
    <link rel="stylesheet" href="../Static/css/sqlmap.css"> <!-- Link to the SQLMap Tool CSS file -->
</head>
<body>

    <!-- Header Section -->
    <header>
        <div class="logo">
            <h1>PentraWeb</h1>
        </div>
        <nav>
            <ul>
                <li><a href="homepage.html" style="color: aquamarine;">Home</a></li>
                <li><a href="scanpage.html">Scan</a></li>
                <li><a href="reportpage.html">Reports</a></li>
                <li><a href="toolspage.html">Tools</a></li>
                <li><a href="bookspage.html">Books</a></li>
                <li><a href="ic_scada.html">IC & SCADA</a></li>
                <li><a href="vulnerable_systems.html">Vulnerable Systems</a></li>
                <li><a href="online_resources.html">Online Resources</a></li>
                <li><a href="aboutpage.html">About</a></li>
                <li><a href="loginpage.html">Login</a></li>
            </ul>
        </nav>
    </header>


    <!-- Main Section -->
    <main>
        <section class="sqlmap-tool">
            <h2>SQLMap SQL Injection Scanner</h2>
            <p>Enter the target URL and configure your SQLMap scan options below.</p>

            <form id="sqlmap-form">
                <label for="target-url">Target URL:</label>
                <input type="text" id="target-url" placeholder="Enter target, e.g., https://example.com" required>

                <label for="scan-type">Select Scan Type:</label>
                <select id="scan-type">
                    <option value="basic">Basic Scan</option>
                    <option value="full">Full Scan</option>
                    <option value="custom">Custom Scan</option>
                </select>

                <div id="custom-scan-options" style="display: none;">
                    <h3>Custom Scan Options</h3>
                    <label><input type="checkbox" id="boolean-blind"> Test for Boolean-Based Blind SQL Injection</label><br>
                    <label><input type="checkbox" id="time-blind"> Test for Time-Based Blind SQL Injection</label><br>
                    <label><input type="checkbox" id="error-based"> Test for Error-Based SQL Injection</label><br>
                    <label><input type="checkbox" id="union-based"> Test for UNION-Based SQL Injection</label><br>
                    <label><input type="checkbox" id="stacked-queries"> Test for Stacked Queries</label><br>

                    <label for="detection-level">Detection Level:</label>
                    <select id="detection-level">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>

                <h3>Authentication Options (Optional)</h3>
                <label for="login-url">Login URL:</label>
                <input type="text" id="login-url" placeholder="Enter login page URL, e.g., https://example.com/login">
                
                <label for="session-cookie">Session Cookie:</label>
                <input type="text" id="session-cookie" placeholder="Enter session cookie, if applicable">
                
                <label for="custom-headers">Custom Headers:</label>
                <textarea id="custom-headers" placeholder="Enter additional headers, if needed"></textarea>

                <h3>Database & Extraction Options</h3>
                <label for="db-type">Target Database Type:</label>
                <select id="db-type">
                    <option value="mysql">MySQL</option>
                    <option value="postgresql">PostgreSQL</option>
                    <option value="mssql">MSSQL</option>
                    <option value="oracle">Oracle</option>
                    <option value="sqlite">SQLite</option>
                </select>
                <label><input type="checkbox" id="retrieve-db-names"> Retrieve Database Names</label><br>
                <label><input type="checkbox" id="retrieve-table-names"> Retrieve Table Names</label><br>
                <label><input type="checkbox" id="retrieve-column-names"> Retrieve Column Names</label><br>
                <label><input type="checkbox" id="dump-table-data"> Dump Table Data</label><br>

                <h3>Advanced Options</h3>
                <label for="scan-speed">Scan Speed:</label>
                <select id="scan-speed">
                    <option value="slow">Slow</option>
                    <option value="normal">Normal</option>
                    <option value="fast">Fast</option>
                </select>
                <label><input type="checkbox" id="waf-bypass"> Enable WAF Bypass Techniques</label><br>
                <label><input type="checkbox" id="use-tor"> Use Tor for Anonymity</label><br>
                <label><input type="checkbox" id="save-logs"> Save Scan Logs</label><br>

                <button type="submit" class="btn">Run Scan</button>
            </form>

            <div id="scan-progress" style="display: none;">
                <p>Scanning for SQL Injection vulnerabilities...</p>
                <div class="progress-bar">
                    <div class="progress" style="width: 0%;"></div>
                </div>
            </div>

            
        </section>

        <div id="scan-results" style="display: none;">
            <h3>Scan Results</h3>
            <table>
                <thead>
                    <tr>
                        <th>Vulnerable Parameter</th>
                        <th>Injection Type</th>
                        <th>Payload Used</th>
                        <th>Database Name</th>
                        <th>Severity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>id</td>
                        <td>UNION-Based SQL Injection</td>
                        <td>' OR 1=1 --</td>
                        <td>example_db</td>
                        <td>Critical</td>
                    </tr>
                    <!-- More results can be added here -->
                </tbody>
            </table>
            <button class="btn" id="save-results">Save Results</button>
            <button class="btn" id="view-extracted-data">View Extracted Data</button>
        </div>
    </main>


    <!-- Footer Section -->
    <footer>
        <div class="contact-info">
            <p>Contact Information</p>
            <p>Email: support@pentraweb.com</p>
        </div>
        <div class="legal">
            <a href="privacy-policy.html">Privacy Policy</a>
            <a href="terms-of-use.html">Terms of Use</a>
        </div>
    </footer>

    <script>
       document.getElementById("sqlmap-form").addEventListener("submit", function(event) {
    event.preventDefault();
    let formData = new FormData(this);

    document.getElementById("scan-results").innerHTML = "Scanning in progress...";
    document.getElementById("scan-results").style.display = "block";

    let eventSource = new EventSource("../Static/php/sqlmap.php", { withCredentials: false });

    eventSource.onmessage = function(event) {
        let resultBox = document.getElementById("scan-results");
        resultBox.innerHTML += "<br>" + event.data;
        resultBox.scrollTop = resultBox.scrollHeight; // Auto-scroll
    };

    eventSource.onerror = function() {
        eventSource.close();
    };

    fetch("scan.php", {
        method: "POST",
        body: formData
    }).then(response => response.json())
      .then(data => console.log(data))
      .catch(error => console.error("Error:", error));
});

    </script>

</body>
</html>
